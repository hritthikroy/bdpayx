<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Icon Diagnostics - BDPayX</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #1E293B;
            color: white;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .section {
            background: #334155;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        .test {
            padding: 15px;
            margin: 10px 0;
            background: #475569;
            border-radius: 8px;
            font-family: monospace;
        }
        .success { border-left: 4px solid #10B981; }
        .error { border-left: 4px solid #EF4444; }
        .warning { border-left: 4px solid #F59E0B; }
        h2 { color: #60A5FA; margin-top: 0; }
        code { background: #1E293B; padding: 2px 6px; border-radius: 4px; }
        .icon-test {
            font-size: 48px;
            display: inline-block;
            margin: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Icon Diagnostics</h1>
        
        <div class="section">
            <h2>1. Font File Check</h2>
            <div id="font-check" class="test">Checking...</div>
        </div>

        <div class="section">
            <h2>2. Font Loading Test</h2>
            <div id="font-load" class="test">Testing...</div>
        </div>

        <div class="section">
            <h2>3. Icon Rendering Test</h2>
            <div class="test">
                <p>If you see icons below (not boxes), fonts are working:</p>
                <div style="background: #1E293B; padding: 20px; border-radius: 8px; margin: 10px 0;">
                    <span class="icon-test" style="font-family: 'MaterialIcons';">home</span>
                    <span class="icon-test" style="font-family: 'MaterialIcons';">account_balance_wallet</span>
                    <span class="icon-test" style="font-family: 'MaterialIcons';">currency_rupee</span>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>4. Flutter App Font Check</h2>
            <div id="flutter-check" class="test">Checking Flutter build...</div>
        </div>

        <div class="section">
            <h2>5. Network Requests</h2>
            <div id="network-check" class="test">Check browser DevTools Network tab for font requests</div>
        </div>

        <div class="section">
            <h2>6. Recommendations</h2>
            <div id="recommendations" class="test"></div>
        </div>
    </div>

    <script>
        // Test 1: Check if font file exists
        fetch('flutter_app/build/web/assets/fonts/MaterialIcons-Regular.otf')
            .then(response => {
                const fontCheck = document.getElementById('font-check');
                if (response.ok) {
                    fontCheck.className = 'test success';
                    fontCheck.innerHTML = `‚úÖ Font file exists: <code>MaterialIcons-Regular.otf</code><br>Size: ${(response.headers.get('content-length') / 1024 / 1024).toFixed(2)} MB`;
                } else {
                    fontCheck.className = 'test error';
                    fontCheck.innerHTML = `‚ùå Font file not found (${response.status})`;
                }
            })
            .catch(err => {
                const fontCheck = document.getElementById('font-check');
                fontCheck.className = 'test error';
                fontCheck.innerHTML = `‚ùå Error checking font: ${err.message}`;
            });

        // Test 2: Font loading
        if (document.fonts) {
            document.fonts.ready.then(() => {
                const fontLoad = document.getElementById('font-load');
                const fonts = Array.from(document.fonts);
                const materialIcons = fonts.filter(f => f.family.includes('MaterialIcons'));
                
                if (materialIcons.length > 0) {
                    fontLoad.className = 'test success';
                    fontLoad.innerHTML = `‚úÖ MaterialIcons font loaded<br>Fonts found: ${materialIcons.map(f => f.family).join(', ')}`;
                } else {
                    fontLoad.className = 'test warning';
                    fontLoad.innerHTML = `‚ö†Ô∏è MaterialIcons not in loaded fonts<br>Loaded fonts: ${fonts.slice(0, 5).map(f => f.family).join(', ')}...`;
                }
            });
        }

        // Test 4: Check Flutter build
        fetch('http://localhost:8080')
            .then(response => response.text())
            .then(html => {
                const flutterCheck = document.getElementById('flutter-check');
                if (html.includes('MaterialIcons')) {
                    flutterCheck.className = 'test success';
                    flutterCheck.innerHTML = '‚úÖ Flutter build includes MaterialIcons reference';
                } else {
                    flutterCheck.className = 'test error';
                    flutterCheck.innerHTML = '‚ùå Flutter build missing MaterialIcons reference';
                }
            });

        // Test 6: Recommendations
        setTimeout(() => {
            const recommendations = document.getElementById('recommendations');
            let html = '<strong>Based on diagnostics:</strong><br><br>';
            
            html += '1. Open Flutter app: <a href="http://localhost:8080" style="color: #60A5FA;">http://localhost:8080</a><br>';
            html += '2. Open DevTools (F12 or Cmd+Option+I)<br>';
            html += '3. Go to Console tab - look for errors<br>';
            html += '4. Go to Network tab - filter by "font" - check if MaterialIcons loads<br>';
            html += '5. Go to Application tab ‚Üí Frames ‚Üí Fonts - see what fonts are loaded<br><br>';
            
            html += '<strong>Common Issues:</strong><br>';
            html += '‚Ä¢ Font file blocked by CORS<br>';
            html += '‚Ä¢ Service Worker caching old version<br>';
            html += '‚Ä¢ Flutter using wrong font family<br>';
            html += '‚Ä¢ Browser cache not cleared<br>';
            
            recommendations.innerHTML = html;
        }, 2000);
    </script>
</body>
</html>
